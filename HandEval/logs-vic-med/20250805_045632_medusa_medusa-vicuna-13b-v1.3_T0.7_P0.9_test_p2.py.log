LlamaForCausalLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From 👉v4.50👈 onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama.LlamaTokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:03,  1.54s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:03<00:01,  1.53s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.29s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:04<00:00,  1.35s/it]
Some weights of MedusaModelLlama were not initialized from the model checkpoint at /home/ubuntu/sd/model_ckpt/vicuna-13b-v1.3 and are newly initialized: ['medusa_head.0.0.linear.bias', 'medusa_head.0.0.linear.weight', 'medusa_head.0.1.weight', 'medusa_head.1.0.linear.bias', 'medusa_head.1.0.linear.weight', 'medusa_head.1.1.weight', 'medusa_head.2.0.linear.bias', 'medusa_head.2.0.linear.weight', 'medusa_head.2.1.weight', 'medusa_head.3.0.linear.bias', 'medusa_head.3.0.linear.weight', 'medusa_head.3.1.weight', 'medusa_head.4.0.linear.bias', 'medusa_head.4.0.linear.weight', 'medusa_head.4.1.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/home/ubuntu/sd/Medusa/medusa/model/medusa_model.py:156: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  medusa_head_state_dict = torch.load(filename, map_location=model.device)
Dataset: data-is-better-together/10k_prompts_ranked:   0%|          | 0/200 [00:00<?, ?it/s]Dataset: data-is-better-together/10k_prompts_ranked:   0%|          | 1/200 [00:06<19:54,  6.00s/it]Dataset: data-is-better-together/10k_prompts_ranked:   1%|          | 2/200 [00:12<20:01,  6.07s/it]Dataset: data-is-better-together/10k_prompts_ranked:   2%|▏         | 3/200 [00:14<14:38,  4.46s/it]Dataset: data-is-better-together/10k_prompts_ranked:   2%|▏         | 4/200 [00:18<13:43,  4.20s/it]Dataset: data-is-better-together/10k_prompts_ranked:   2%|▎         | 5/200 [00:24<15:51,  4.88s/it]Dataset: data-is-better-together/10k_prompts_ranked:   3%|▎         | 6/200 [00:30<16:52,  5.22s/it]Dataset: data-is-better-together/10k_prompts_ranked:   4%|▎         | 7/200 [00:36<17:53,  5.56s/it]Dataset: data-is-better-together/10k_prompts_ranked:   4%|▍         | 8/200 [00:37<12:58,  4.06s/it]Dataset: data-is-better-together/10k_prompts_ranked:   4%|▍         | 9/200 [00:43<15:00,  4.71s/it]Dataset: data-is-better-together/10k_prompts_ranked:   5%|▌         | 10/200 [00:47<13:47,  4.36s/it]Dataset: data-is-better-together/10k_prompts_ranked:   6%|▌         | 11/200 [00:53<15:25,  4.90s/it]Dataset: data-is-better-together/10k_prompts_ranked:   6%|▌         | 12/200 [00:53<11:06,  3.54s/it]Dataset: data-is-better-together/10k_prompts_ranked:   6%|▋         | 13/200 [00:56<09:50,  3.16s/it]Dataset: data-is-better-together/10k_prompts_ranked:   7%|▋         | 14/200 [00:59<09:39,  3.12s/it]Dataset: data-is-better-together/10k_prompts_ranked:   8%|▊         | 15/200 [01:04<11:29,  3.73s/it]Dataset: data-is-better-together/10k_prompts_ranked:   8%|▊         | 16/200 [01:10<13:36,  4.44s/it]Dataset: data-is-better-together/10k_prompts_ranked:   8%|▊         | 17/200 [01:13<12:16,  4.03s/it]Dataset: data-is-better-together/10k_prompts_ranked:   9%|▉         | 18/200 [01:14<09:24,  3.10s/it]Dataset: data-is-better-together/10k_prompts_ranked:  10%|▉         | 19/200 [01:17<09:25,  3.12s/it]Dataset: data-is-better-together/10k_prompts_ranked:  10%|█         | 20/200 [01:18<07:49,  2.61s/it]Dataset: data-is-better-together/10k_prompts_ranked:  10%|█         | 21/200 [01:20<06:50,  2.29s/it]Dataset: data-is-better-together/10k_prompts_ranked:  11%|█         | 22/200 [01:22<06:57,  2.34s/it]Dataset: data-is-better-together/10k_prompts_ranked:  12%|█▏        | 23/200 [01:25<06:49,  2.31s/it]Dataset: data-is-better-together/10k_prompts_ranked:  12%|█▏        | 24/200 [01:30<09:10,  3.13s/it]Dataset: data-is-better-together/10k_prompts_ranked:  12%|█▎        | 25/200 [01:32<08:23,  2.88s/it]Dataset: data-is-better-together/10k_prompts_ranked:  13%|█▎        | 26/200 [01:38<11:06,  3.83s/it]Dataset: data-is-better-together/10k_prompts_ranked:  14%|█▎        | 27/200 [01:40<09:37,  3.34s/it]Dataset: data-is-better-together/10k_prompts_ranked:  14%|█▍        | 28/200 [01:41<07:45,  2.71s/it]Dataset: data-is-better-together/10k_prompts_ranked:  14%|█▍        | 29/200 [01:44<07:38,  2.68s/it]Dataset: data-is-better-together/10k_prompts_ranked:  15%|█▌        | 30/200 [01:47<07:36,  2.68s/it]Dataset: data-is-better-together/10k_prompts_ranked:  16%|█▌        | 31/200 [01:49<07:08,  2.54s/it]Dataset: data-is-better-together/10k_prompts_ranked:  16%|█▌        | 32/200 [01:55<10:06,  3.61s/it]Dataset: data-is-better-together/10k_prompts_ranked:  16%|█▋        | 33/200 [02:01<12:12,  4.39s/it]Dataset: data-is-better-together/10k_prompts_ranked:  17%|█▋        | 34/200 [02:04<10:47,  3.90s/it]Dataset: data-is-better-together/10k_prompts_ranked:  18%|█▊        | 35/200 [02:08<10:20,  3.76s/it]Dataset: data-is-better-together/10k_prompts_ranked:  18%|█▊        | 36/200 [02:14<12:14,  4.48s/it]Dataset: data-is-better-together/10k_prompts_ranked:  18%|█▊        | 37/200 [02:16<10:49,  3.98s/it]Dataset: data-is-better-together/10k_prompts_ranked:  19%|█▉        | 38/200 [02:23<12:28,  4.62s/it]Dataset: data-is-better-together/10k_prompts_ranked:  20%|█▉        | 39/200 [02:24<09:42,  3.62s/it]Dataset: data-is-better-together/10k_prompts_ranked:  20%|██        | 40/200 [02:27<09:31,  3.57s/it]Dataset: data-is-better-together/10k_prompts_ranked:  20%|██        | 41/200 [02:28<07:11,  2.71s/it]Dataset: data-is-better-together/10k_prompts_ranked:  21%|██        | 42/200 [02:32<08:24,  3.19s/it]Dataset: data-is-better-together/10k_prompts_ranked:  22%|██▏       | 43/200 [02:34<06:56,  2.65s/it]Dataset: data-is-better-together/10k_prompts_ranked:  22%|██▏       | 44/200 [02:40<09:35,  3.69s/it]Dataset: data-is-better-together/10k_prompts_ranked:  22%|██▎       | 45/200 [02:42<08:23,  3.25s/it]Dataset: data-is-better-together/10k_prompts_ranked:  23%|██▎       | 46/200 [02:44<07:06,  2.77s/it]Dataset: data-is-better-together/10k_prompts_ranked:  24%|██▎       | 47/200 [02:44<05:16,  2.07s/it]Dataset: data-is-better-together/10k_prompts_ranked:  24%|██▍       | 48/200 [02:44<03:52,  1.53s/it]Dataset: data-is-better-together/10k_prompts_ranked:  24%|██▍       | 49/200 [02:47<04:59,  1.98s/it]Dataset: data-is-better-together/10k_prompts_ranked:  25%|██▌       | 50/200 [02:51<05:57,  2.38s/it]Dataset: data-is-better-together/10k_prompts_ranked:  26%|██▌       | 51/200 [02:51<04:31,  1.82s/it]Dataset: data-is-better-together/10k_prompts_ranked:  26%|██▌       | 52/200 [02:55<06:13,  2.53s/it]Dataset: data-is-better-together/10k_prompts_ranked:  26%|██▋       | 53/200 [02:57<05:35,  2.28s/it]Dataset: data-is-better-together/10k_prompts_ranked:  27%|██▋       | 54/200 [02:58<04:25,  1.82s/it]Dataset: data-is-better-together/10k_prompts_ranked:  28%|██▊       | 55/200 [03:00<04:33,  1.88s/it]Dataset: data-is-better-together/10k_prompts_ranked:  28%|██▊       | 56/200 [03:01<04:04,  1.70s/it]Dataset: data-is-better-together/10k_prompts_ranked:  28%|██▊       | 57/200 [03:05<05:11,  2.18s/it]Dataset: data-is-better-together/10k_prompts_ranked:  30%|██▉       | 59/200 [03:08<04:51,  2.06s/it]Dataset: data-is-better-together/10k_prompts_ranked:  30%|███       | 60/200 [03:15<07:09,  3.07s/it]Dataset: data-is-better-together/10k_prompts_ranked:  30%|███       | 61/200 [03:20<08:19,  3.59s/it]Dataset: data-is-better-together/10k_prompts_ranked:  31%|███       | 62/200 [03:23<08:11,  3.56s/it]Dataset: data-is-better-together/10k_prompts_ranked:  32%|███▏      | 63/200 [03:29<09:27,  4.14s/it]Dataset: data-is-better-together/10k_prompts_ranked:  32%|███▏      | 64/200 [03:30<07:32,  3.32s/it]Dataset: data-is-better-together/10k_prompts_ranked:  32%|███▎      | 65/200 [03:35<08:26,  3.75s/it]Dataset: data-is-better-together/10k_prompts_ranked:  33%|███▎      | 66/200 [03:37<07:42,  3.45s/it]Dataset: data-is-better-together/10k_prompts_ranked:  34%|███▎      | 67/200 [03:39<06:19,  2.85s/it]Dataset: data-is-better-together/10k_prompts_ranked:  34%|███▍      | 68/200 [03:41<05:45,  2.62s/it]Dataset: data-is-better-together/10k_prompts_ranked:  34%|███▍      | 69/200 [03:41<04:13,  1.94s/it]Dataset: data-is-better-together/10k_prompts_ranked:  35%|███▌      | 70/200 [03:42<03:12,  1.48s/it]Dataset: data-is-better-together/10k_prompts_ranked:  36%|███▌      | 71/200 [03:42<02:22,  1.11s/it]Dataset: data-is-better-together/10k_prompts_ranked:  36%|███▌      | 72/200 [03:47<05:11,  2.43s/it]Dataset: data-is-better-together/10k_prompts_ranked:  36%|███▋      | 73/200 [03:50<05:21,  2.53s/it]Dataset: data-is-better-together/10k_prompts_ranked:  37%|███▋      | 74/200 [03:53<05:26,  2.59s/it]Dataset: data-is-better-together/10k_prompts_ranked:  38%|███▊      | 75/200 [03:59<07:34,  3.64s/it]Dataset: data-is-better-together/10k_prompts_ranked:  38%|███▊      | 76/200 [04:05<09:01,  4.37s/it]Dataset: data-is-better-together/10k_prompts_ranked:  38%|███▊      | 77/200 [04:09<08:42,  4.25s/it]Dataset: data-is-better-together/10k_prompts_ranked:  39%|███▉      | 78/200 [04:10<06:23,  3.14s/it]Dataset: data-is-better-together/10k_prompts_ranked:  40%|███▉      | 79/200 [04:14<06:46,  3.36s/it]Dataset: data-is-better-together/10k_prompts_ranked:  40%|████      | 80/200 [04:18<07:25,  3.71s/it]Dataset: data-is-better-together/10k_prompts_ranked:  40%|████      | 81/200 [04:23<07:57,  4.01s/it]Dataset: data-is-better-together/10k_prompts_ranked:  41%|████      | 82/200 [04:23<05:43,  2.91s/it]Dataset: data-is-better-together/10k_prompts_ranked:  42%|████▏     | 83/200 [04:24<04:28,  2.29s/it]Dataset: data-is-better-together/10k_prompts_ranked:  42%|████▏     | 84/200 [04:27<04:43,  2.45s/it]Dataset: data-is-better-together/10k_prompts_ranked:  42%|████▎     | 85/200 [04:30<04:51,  2.54s/it]Dataset: data-is-better-together/10k_prompts_ranked:  43%|████▎     | 86/200 [04:36<06:54,  3.63s/it]Dataset: data-is-better-together/10k_prompts_ranked:  44%|████▎     | 87/200 [04:41<07:34,  4.02s/it]Dataset: data-is-better-together/10k_prompts_ranked:  44%|████▍     | 88/200 [04:42<05:50,  3.13s/it]Dataset: data-is-better-together/10k_prompts_ranked:  44%|████▍     | 89/200 [04:48<07:27,  4.03s/it]Dataset: data-is-better-together/10k_prompts_ranked:  45%|████▌     | 90/200 [04:54<08:32,  4.66s/it]Dataset: data-is-better-together/10k_prompts_ranked:  46%|████▌     | 91/200 [04:55<06:18,  3.47s/it]Dataset: data-is-better-together/10k_prompts_ranked:  46%|████▌     | 92/200 [04:57<05:35,  3.11s/it]Dataset: data-is-better-together/10k_prompts_ranked:  46%|████▋     | 93/200 [04:59<05:03,  2.84s/it]Dataset: data-is-better-together/10k_prompts_ranked:  47%|████▋     | 94/200 [05:02<05:09,  2.92s/it]Dataset: data-is-better-together/10k_prompts_ranked:  48%|████▊     | 95/200 [05:08<06:47,  3.88s/it]Dataset: data-is-better-together/10k_prompts_ranked:  48%|████▊     | 96/200 [05:11<06:07,  3.53s/it]Dataset: data-is-better-together/10k_prompts_ranked:  48%|████▊     | 97/200 [05:12<04:40,  2.72s/it]Dataset: data-is-better-together/10k_prompts_ranked:  49%|████▉     | 98/200 [05:17<05:35,  3.29s/it]Dataset: data-is-better-together/10k_prompts_ranked:  50%|████▉     | 99/200 [05:19<05:15,  3.13s/it]Dataset: data-is-better-together/10k_prompts_ranked:  50%|█████     | 100/200 [05:19<03:42,  2.22s/it]Dataset: data-is-better-together/10k_prompts_ranked:  50%|█████     | 101/200 [05:22<03:54,  2.37s/it]Dataset: data-is-better-together/10k_prompts_ranked:  51%|█████     | 102/200 [05:24<03:50,  2.36s/it]Dataset: data-is-better-together/10k_prompts_ranked:  52%|█████▏    | 103/200 [05:27<03:44,  2.32s/it]Dataset: data-is-better-together/10k_prompts_ranked:  52%|█████▏    | 104/200 [05:32<05:02,  3.15s/it]Token indices sequence length is longer than the specified maximum sequence length for this model (3654 > 2048). Running this sequence through the model will result in indexing errors
Dataset: data-is-better-together/10k_prompts_ranked:  52%|█████▎    | 105/200 [05:32<03:48,  2.41s/it]Dataset: data-is-better-together/10k_prompts_ranked:  53%|█████▎    | 106/200 [05:39<05:32,  3.54s/it]Dataset: data-is-better-together/10k_prompts_ranked:  54%|█████▎    | 107/200 [05:45<06:40,  4.30s/it]Dataset: data-is-better-together/10k_prompts_ranked:  54%|█████▍    | 108/200 [05:47<05:40,  3.71s/it]Dataset: data-is-better-together/10k_prompts_ranked:  55%|█████▍    | 109/200 [05:48<04:22,  2.89s/it]Dataset: data-is-better-together/10k_prompts_ranked:  55%|█████▌    | 110/200 [05:54<05:46,  3.85s/it]Dataset: data-is-better-together/10k_prompts_ranked:  56%|█████▌    | 111/200 [05:56<05:01,  3.39s/it]Dataset: data-is-better-together/10k_prompts_ranked:  56%|█████▌    | 112/200 [05:59<04:41,  3.20s/it]Dataset: data-is-better-together/10k_prompts_ranked:  56%|█████▋    | 113/200 [06:03<04:57,  3.42s/it]Dataset: data-is-better-together/10k_prompts_ranked:  57%|█████▋    | 114/200 [06:04<03:45,  2.62s/it]Dataset: data-is-better-together/10k_prompts_ranked:  57%|█████▊    | 115/200 [06:04<02:52,  2.02s/it]Dataset: data-is-better-together/10k_prompts_ranked:  58%|█████▊    | 116/200 [06:05<02:04,  1.49s/it]Dataset: data-is-better-together/10k_prompts_ranked:  58%|█████▊    | 117/200 [06:05<01:41,  1.22s/it]Dataset: data-is-better-together/10k_prompts_ranked:  59%|█████▉    | 118/200 [06:09<02:47,  2.05s/it]Dataset: data-is-better-together/10k_prompts_ranked:  60%|█████▉    | 119/200 [06:15<04:24,  3.27s/it]Dataset: data-is-better-together/10k_prompts_ranked:  60%|██████    | 120/200 [06:22<05:31,  4.15s/it]Dataset: data-is-better-together/10k_prompts_ranked:  60%|██████    | 121/200 [06:25<05:00,  3.80s/it]Dataset: data-is-better-together/10k_prompts_ranked:  61%|██████    | 122/200 [06:27<04:30,  3.47s/it]Dataset: data-is-better-together/10k_prompts_ranked:  62%|██████▏   | 123/200 [06:33<05:28,  4.27s/it]Dataset: data-is-better-together/10k_prompts_ranked:  62%|██████▏   | 124/200 [06:37<05:07,  4.04s/it]Dataset: data-is-better-together/10k_prompts_ranked:  62%|██████▎   | 125/200 [06:38<03:45,  3.01s/it]Dataset: data-is-better-together/10k_prompts_ranked:  63%|██████▎   | 126/200 [06:38<02:48,  2.28s/it]Dataset: data-is-better-together/10k_prompts_ranked:  64%|██████▎   | 127/200 [06:43<03:42,  3.04s/it]Dataset: data-is-better-together/10k_prompts_ranked:  64%|██████▍   | 128/200 [06:43<02:35,  2.17s/it]Dataset: data-is-better-together/10k_prompts_ranked:  64%|██████▍   | 129/200 [06:47<03:04,  2.59s/it]Dataset: data-is-better-together/10k_prompts_ranked:  65%|██████▌   | 130/200 [06:48<02:32,  2.18s/it]Dataset: data-is-better-together/10k_prompts_ranked:  66%|██████▌   | 131/200 [06:50<02:37,  2.28s/it]Dataset: data-is-better-together/10k_prompts_ranked:  66%|██████▌   | 132/200 [06:51<02:12,  1.94s/it]Dataset: data-is-better-together/10k_prompts_ranked:  66%|██████▋   | 133/200 [06:53<02:02,  1.83s/it]Dataset: data-is-better-together/10k_prompts_ranked:  67%|██████▋   | 134/200 [06:53<01:29,  1.35s/it]Dataset: data-is-better-together/10k_prompts_ranked:  68%|██████▊   | 135/200 [06:54<01:07,  1.04s/it]Dataset: data-is-better-together/10k_prompts_ranked:  68%|██████▊   | 136/200 [06:54<01:01,  1.04it/s]Dataset: data-is-better-together/10k_prompts_ranked:  68%|██████▊   | 137/200 [06:56<01:10,  1.12s/it]Dataset: data-is-better-together/10k_prompts_ranked:  69%|██████▉   | 138/200 [06:59<01:49,  1.76s/it]Dataset: data-is-better-together/10k_prompts_ranked:  70%|██████▉   | 139/200 [07:05<03:07,  3.08s/it]Dataset: data-is-better-together/10k_prompts_ranked:  70%|███████   | 140/200 [07:09<03:09,  3.16s/it]Dataset: data-is-better-together/10k_prompts_ranked:  70%|███████   | 141/200 [07:12<03:06,  3.16s/it]Dataset: data-is-better-together/10k_prompts_ranked:  71%|███████   | 142/200 [07:15<02:56,  3.04s/it]Dataset: data-is-better-together/10k_prompts_ranked:  72%|███████▏  | 143/200 [07:16<02:18,  2.43s/it]Dataset: data-is-better-together/10k_prompts_ranked:  72%|███████▏  | 144/200 [07:16<01:38,  1.77s/it]Dataset: data-is-better-together/10k_prompts_ranked:  72%|███████▎  | 145/200 [07:19<01:56,  2.11s/it]Dataset: data-is-better-together/10k_prompts_ranked:  73%|███████▎  | 146/200 [07:19<01:24,  1.57s/it]Dataset: data-is-better-together/10k_prompts_ranked:  74%|███████▎  | 147/200 [07:25<02:35,  2.94s/it]Dataset: data-is-better-together/10k_prompts_ranked:  74%|███████▍  | 148/200 [07:31<03:23,  3.91s/it]Dataset: data-is-better-together/10k_prompts_ranked:  74%|███████▍  | 149/200 [07:34<03:00,  3.53s/it]Dataset: data-is-better-together/10k_prompts_ranked:  75%|███████▌  | 150/200 [07:35<02:15,  2.71s/it]Dataset: data-is-better-together/10k_prompts_ranked:  76%|███████▌  | 151/200 [07:37<02:04,  2.55s/it]Dataset: data-is-better-together/10k_prompts_ranked:  76%|███████▌  | 152/200 [07:39<02:01,  2.53s/it]Dataset: data-is-better-together/10k_prompts_ranked:  76%|███████▋  | 153/200 [07:41<01:42,  2.18s/it]Dataset: data-is-better-together/10k_prompts_ranked:  77%|███████▋  | 154/200 [07:47<02:34,  3.37s/it]Dataset: data-is-better-together/10k_prompts_ranked:  78%|███████▊  | 155/200 [07:47<01:47,  2.40s/it]Dataset: data-is-better-together/10k_prompts_ranked:  78%|███████▊  | 156/200 [07:53<02:32,  3.47s/it]Dataset: data-is-better-together/10k_prompts_ranked:  78%|███████▊  | 157/200 [07:55<02:12,  3.09s/it]Dataset: data-is-better-together/10k_prompts_ranked:  79%|███████▉  | 158/200 [07:58<02:08,  3.06s/it]Dataset: data-is-better-together/10k_prompts_ranked:  80%|███████▉  | 159/200 [08:00<01:53,  2.78s/it]Dataset: data-is-better-together/10k_prompts_ranked:  80%|████████  | 160/200 [08:03<01:48,  2.71s/it]Dataset: data-is-better-together/10k_prompts_ranked:  80%|████████  | 161/200 [08:05<01:34,  2.41s/it]Dataset: data-is-better-together/10k_prompts_ranked:  81%|████████  | 162/200 [08:11<02:14,  3.54s/it]Dataset: data-is-better-together/10k_prompts_ranked:  82%|████████▏ | 163/200 [08:12<01:41,  2.74s/it]Dataset: data-is-better-together/10k_prompts_ranked:  82%|████████▏ | 164/200 [08:14<01:38,  2.73s/it]Dataset: data-is-better-together/10k_prompts_ranked:  82%|████████▎ | 165/200 [08:20<02:11,  3.74s/it]Dataset: data-is-better-together/10k_prompts_ranked:  83%|████████▎ | 166/200 [08:24<02:02,  3.59s/it]Dataset: data-is-better-together/10k_prompts_ranked:  84%|████████▎ | 167/200 [08:29<02:19,  4.22s/it]Dataset: data-is-better-together/10k_prompts_ranked:  84%|████████▍ | 168/200 [08:32<02:01,  3.81s/it]Dataset: data-is-better-together/10k_prompts_ranked:  84%|████████▍ | 169/200 [08:37<02:05,  4.04s/it]Dataset: data-is-better-together/10k_prompts_ranked:  85%|████████▌ | 170/200 [08:38<01:38,  3.28s/it]Dataset: data-is-better-together/10k_prompts_ranked:  86%|████████▌ | 171/200 [08:43<01:46,  3.66s/it]Dataset: data-is-better-together/10k_prompts_ranked:  86%|████████▌ | 172/200 [08:46<01:38,  3.52s/it]Dataset: data-is-better-together/10k_prompts_ranked:  86%|████████▋ | 173/200 [08:49<01:32,  3.42s/it]Dataset: data-is-better-together/10k_prompts_ranked:  87%|████████▋ | 174/200 [08:51<01:19,  3.06s/it]Dataset: data-is-better-together/10k_prompts_ranked:  88%|████████▊ | 175/200 [08:54<01:13,  2.93s/it]Dataset: data-is-better-together/10k_prompts_ranked:  88%|████████▊ | 176/200 [08:59<01:25,  3.56s/it]Dataset: data-is-better-together/10k_prompts_ranked:  88%|████████▊ | 177/200 [09:05<01:39,  4.31s/it]Dataset: data-is-better-together/10k_prompts_ranked:  89%|████████▉ | 178/200 [09:06<01:14,  3.39s/it]Dataset: data-is-better-together/10k_prompts_ranked:  90%|████████▉ | 179/200 [09:11<01:17,  3.70s/it]Dataset: data-is-better-together/10k_prompts_ranked:  90%|█████████ | 180/200 [09:13<01:05,  3.26s/it]Dataset: data-is-better-together/10k_prompts_ranked:  90%|█████████ | 181/200 [09:14<00:47,  2.51s/it]Dataset: data-is-better-together/10k_prompts_ranked:  91%|█████████ | 182/200 [09:17<00:46,  2.59s/it]Dataset: data-is-better-together/10k_prompts_ranked:  92%|█████████▏| 183/200 [09:18<00:35,  2.08s/it]Dataset: data-is-better-together/10k_prompts_ranked:  92%|█████████▏| 184/200 [09:20<00:34,  2.18s/it]Dataset: data-is-better-together/10k_prompts_ranked:  92%|█████████▎| 185/200 [09:26<00:48,  3.26s/it]Dataset: data-is-better-together/10k_prompts_ranked:  93%|█████████▎| 186/200 [09:30<00:50,  3.58s/it]Dataset: data-is-better-together/10k_prompts_ranked:  94%|█████████▎| 187/200 [09:34<00:46,  3.56s/it]Dataset: data-is-better-together/10k_prompts_ranked:  94%|█████████▍| 188/200 [09:35<00:33,  2.81s/it]Dataset: data-is-better-together/10k_prompts_ranked:  94%|█████████▍| 189/200 [09:37<00:30,  2.79s/it]Dataset: data-is-better-together/10k_prompts_ranked:  95%|█████████▌| 190/200 [09:40<00:27,  2.73s/it]Dataset: data-is-better-together/10k_prompts_ranked:  96%|█████████▌| 191/200 [09:43<00:25,  2.83s/it]Dataset: data-is-better-together/10k_prompts_ranked:  96%|█████████▌| 192/200 [09:43<00:16,  2.10s/it]Dataset: data-is-better-together/10k_prompts_ranked:  96%|█████████▋| 193/200 [09:45<00:13,  2.00s/it]Dataset: data-is-better-together/10k_prompts_ranked:  97%|█████████▋| 194/200 [09:51<00:18,  3.12s/it]Dataset: data-is-better-together/10k_prompts_ranked:  98%|█████████▊| 195/200 [09:55<00:17,  3.52s/it]Dataset: data-is-better-together/10k_prompts_ranked:  98%|█████████▊| 196/200 [09:56<00:10,  2.58s/it]Dataset: data-is-better-together/10k_prompts_ranked:  98%|█████████▊| 197/200 [09:59<00:08,  2.82s/it]Dataset: data-is-better-together/10k_prompts_ranked:  99%|█████████▉| 198/200 [10:02<00:05,  2.81s/it]Dataset: data-is-better-together/10k_prompts_ranked: 100%|█████████▉| 199/200 [10:03<00:02,  2.18s/it]Dataset: data-is-better-together/10k_prompts_ranked: 100%|██████████| 200/200 [10:06<00:00,  2.47s/it]Dataset: data-is-better-together/10k_prompts_ranked: 100%|██████████| 200/200 [10:06<00:00,  3.03s/it]
Average accept_length: 1.3203463554382324
Average accept_length: 1.54296875
Average accept_length: 1.4433962106704712
Average accept_length: 1.4968552589416504
Average accept_length: 1.6875
Average accept_length: 1.195833444595337
Average accept_length: 1.7890625
Average accept_length: 0.8529411554336548
Average accept_length: 1.97265625
Average accept_length: 1.7333333492279053
Average accept_length: 1.40234375
Average accept_length: 1.0555555820465088
Average accept_length: 1.2000000476837158
Average accept_length: 1.7619048357009888
Average accept_length: 1.6267942190170288
Average accept_length: 1.31640625
Average accept_length: 1.7751938104629517
Average accept_length: 1.6410256624221802
Average accept_length: 0.9272726774215698
Average accept_length: 1.3559322357177734
Average accept_length: 1.3230769634246826
Average accept_length: 1.5436893701553345
Average accept_length: 1.4468084573745728
Average accept_length: 1.2476191520690918
Average accept_length: 1.59375
Average accept_length: 1.52734375
Average accept_length: 2.33695650100708
Average accept_length: 1.5576924085617065
Average accept_length: 1.576576590538025
Average accept_length: 1.4910714626312256
Average accept_length: 1.47826087474823
Average accept_length: 1.0390625
Average accept_length: 1.671875
Average accept_length: 2.060344934463501
Average accept_length: 1.4055943489074707
Average accept_length: 1.44921875
Average accept_length: 1.8487396240234375
Average accept_length: 1.3984375
Average accept_length: 0.5925925970077515
Average accept_length: 1.7123287916183472
Average accept_length: 1.3793103694915771
Average accept_length: 1.2099448442459106
Average accept_length: 1.2881356477737427
Average accept_length: 1.5703125
Average accept_length: 2.63043475151062
Average accept_length: 2.2608695030212402
Average accept_length: 1.8235293626785278
Average accept_length: 0.6363636255264282
Average accept_length: 1.5390625
Average accept_length: 1.4820144176483154
Average accept_length: 1.3333333730697632
Average accept_length: 2.132183790206909
Average accept_length: 1.3943661451339722
Average accept_length: 1.533333420753479
Average accept_length: 1.6279069185256958
Average accept_length: 1.634615421295166
Average accept_length: 1.3428571224212646
Average accept_length: 0.0
Average accept_length: 1.52201247215271
Average accept_length: 1.0625
Average accept_length: 1.8066037893295288
Average accept_length: 1.1931034326553345
Average accept_length: 1.0717298984527588
Average accept_length: 2.037735939025879
Average accept_length: 1.9195979833602905
Average accept_length: 1.1938775777816772
Average accept_length: 2.3728814125061035
Average accept_length: 1.9310344457626343
Average accept_length: 1.076923131942749
Average accept_length: 1.2352941036224365
Average accept_length: 2.125
Average accept_length: 1.2905983924865723
Average accept_length: 1.4521738290786743
Average accept_length: 1.5999999046325684
Average accept_length: 1.40625
Average accept_length: 1.6171875
Average accept_length: 1.5029586553573608
Average accept_length: 1.56521737575531
Average accept_length: 1.5398772954940796
Average accept_length: 2.0789475440979004
Average accept_length: 1.3399999141693115
Average accept_length: 1.571428656578064
Average accept_length: 1.5428571701049805
Average accept_length: 1.4583333730697632
Average accept_length: 1.3362069129943848
Average accept_length: 1.88671875
Average accept_length: 1.95652174949646
Average accept_length: 1.9302325248718262
Average accept_length: 1.58984375
Average accept_length: 1.8125
Average accept_length: 2.4482758045196533
Average accept_length: 1.5957446098327637
Average accept_length: 1.8478261232376099
Average accept_length: 1.407692313194275
Average accept_length: 1.37890625
Average accept_length: 1.1140351295471191
Average accept_length: 1.399999976158142
Average accept_length: 1.5544041395187378
Average accept_length: 1.2758620977401733
Average accept_length: 1.5
Average accept_length: 1.6578947305679321
Average accept_length: 1.2857142686843872
Average accept_length: 1.451612949371338
Average accept_length: 1.7761905193328857
Average accept_length: 1.0
Average accept_length: 1.7890625
Average accept_length: 0.9365079998970032
Average accept_length: 1.5670102834701538
Average accept_length: 1.2195121049880981
Average accept_length: 1.10546875
Average accept_length: 1.8453607559204102
Average accept_length: 1.6491228342056274
Average accept_length: 1.0969696044921875
Average accept_length: 1.2580645084381104
Average accept_length: 0.9230769872665405
Average accept_length: 1.5555555820465088
Average accept_length: 1.7916667461395264
Average accept_length: 1.9281437397003174
Average accept_length: 2.09375
Average accept_length: 1.59765625
Average accept_length: 1.8790322542190552
Average accept_length: 1.7321429252624512
Average accept_length: 1.1484375
Average accept_length: 1.0335570573806763
Average accept_length: 1.0799999237060547
Average accept_length: 2.3043477535247803
Average accept_length: 1.916256070137024
Average accept_length: 2.25
Average accept_length: 1.4276316165924072
Average accept_length: 1.6399999856948853
Average accept_length: 1.8666667938232422
Average accept_length: 1.7708333730697632
Average accept_length: 1.4461538791656494
Average accept_length: 1.4444444179534912
Average accept_length: 1.384615421295166
Average accept_length: 1.09375
Average accept_length: 1.5161290168762207
Average accept_length: 1.4632352590560913
Average accept_length: 1.37890625
Average accept_length: 1.3478261232376099
Average accept_length: 2.082706928253174
Average accept_length: 1.3017240762710571
Average accept_length: 1.3571429252624512
Average accept_length: 1.5
Average accept_length: 1.892561912536621
Average accept_length: 2.5
Average accept_length: 1.4453125
Average accept_length: 1.78125
Average accept_length: 2.414414405822754
Average accept_length: 1.03125
Average accept_length: 1.1777777671813965
Average accept_length: 1.7307692766189575
Average accept_length: 1.2321429252624512
Average accept_length: 1.484375
Average accept_length: 1.600000023841858
Average accept_length: 1.5560001134872437
Average accept_length: 2.076923131942749
Average accept_length: 1.6774193048477173
Average accept_length: 2.0681819915771484
Average accept_length: 2.047619104385376
Average accept_length: 1.366197109222412
Average accept_length: 1.39453125
Average accept_length: 0.8928571939468384
Average accept_length: 1.3928571939468384
Average accept_length: 1.58984375
Average accept_length: 1.3868613243103027
Average accept_length: 1.4541667699813843
Average accept_length: 1.4621849060058594
Average accept_length: 1.5104167461395264
Average accept_length: 1.1632652282714844
Average accept_length: 1.2727272510528564
Average accept_length: 1.7352941036224365
Average accept_length: 1.522727370262146
Average accept_length: 1.3260869979858398
Average accept_length: 1.7090908288955688
Average accept_length: 1.2142857313156128
Average accept_length: 1.2834645509719849
Average accept_length: 1.4230769872665405
Average accept_length: 1.4432432651519775
Average accept_length: 1.33695650100708
Average accept_length: 2.1290321350097656
Average accept_length: 1.8521738052368164
Average accept_length: 1.5277777910232544
Average accept_length: 1.1399999856948853
Average accept_length: 1.5514402389526367
Average accept_length: 1.7611111402511597
Average accept_length: 2.3013699054718018
Average accept_length: 0.9333333373069763
Average accept_length: 1.4649122953414917
Average accept_length: 2.112149477005005
Average accept_length: 1.571428656578064
Average accept_length: 1.3333333730697632
Average accept_length: 1.2676056623458862
Average accept_length: 2.037656784057617
Average accept_length: 2.4946236610412598
Average accept_length: 1.8125
Average accept_length: 1.8714286088943481
Average accept_length: 1.3362069129943848
Average accept_length: 2.1379311084747314
Average accept_length: 1.610687017440796
🔄 Completions saved to /home/ubuntu/sd/HandEval/outputs/medusa-vicuna-13b-v1.3/data-is-better-together/10k_prompts_ranked_completions.jsonl

✅  Results saved to /home/ubuntu/sd/HandEval/outputs/medusa-vicuna-13b-v1.3/data-is-better-together/10k_prompts_ranked_metrics.json
{
  "num_samples": 200,
  "total_time_sec": 606.2745513916016,
  "avg_time_per_sample_sec": 3.031372756958008,
  "samples_file": "outputs/medusa-vicuna-13b-v1.3/data-is-better-together/10k_prompts_ranked_completions.jsonl"
}
